clouda.define("mbaas/app",function(){function o(){return clouda.RUNTIME===clouda.RUNTIMES.KUANG&&clouda.PLATFORM===clouda.PLATFORMS.IOS&&"function"==typeof BLightApp.addLAPush?!0:!1}function u(o,u,n){var c={appid:n.appid,statis_ext:{src:"clouda"},push_action:u};n.nonce&&(c.nonce=n.nonce),n.csrftoken&&(c.csrftoken=n.csrftoken),n.tag&&(c.tags=[n.tag]);var s={push_params:c},t=function(){n.onsuccess(1)},e=function(o){n.onfail(o)};return a(o,JSON.stringify(s),t,e),!1}var n=clouda.lightapp,c=clouda.mbaas.app={},a=(clouda.mbaas||{},clouda.DelegateClass,clouda.kuangForReady,clouda.runtimeError,clouda.installPlugin,clouda.cloudaBLight),s=clouda.ErrCode;c.followSite=function(c,t){if(c){if(clouda.lib.utils.setLogStorage("app","followSite"),clouda.PLATFORM===clouda.PLATFORMS.IOS){if(o())return t.appid=c,void u("addLAPush","subscribe",t);if(navigator.userAgent.match(/baiduboxapp\/([\d.-_]*)/i)&&clouda.RUNTIME!==clouda.RUNTIMES.KUANG){if(clouda.RUNTIME_VERSION<"6.1")return t.onsuccess&&"function"==typeof t.onsuccess&&t.onsuccess(0),void clouda.lib.moplus.openApp(!1,c,{tip:"请使用最新版【手机百度】\n订阅",startDownload:1,platform:"ios"});if(clouda.RUNTIME_VERSION>="6.1")return void clouda.lib.moplus.openApp(!0,c)}else if(clouda.RUNTIME===clouda.RUNTIMES.KUANG)return t.onsuccess&&"function"==typeof t.onsuccess&&t.onsuccess(0),void clouda.lib.moplus.openApp(!1,c,{tip:"请使用最新版【手机百度】\n订阅",startDownload:1,platform:"ios"})}return clouda.RUNTIME===clouda.RUNTIMES.KUANG?clouda.RUNTIME_VERSION<"5.3"?(t.onsuccess&&"function"==typeof t.onsuccess&&t.onsuccess(0),void clouda.lib.moplus.openApp(!1,c,{tip:"请使用最新版【手机百度】\n订阅",startDownload:1})):(a("followSite",function(){t.onsuccess(clouda.STATUS.SUCCESS)},t.onfail),!1):"undefined"!=typeof BLightApp||navigator.userAgent.match(/baiduboxapp\/([\d.-_]*)/i)?clouda.RUNTIME_VERSION>="5.3"?void clouda.lib.moplus.openApp(!0,c):(t.onsuccess&&"function"==typeof t.onsuccess&&t.onsuccess(0),void clouda.lib.moplus.openApp(!1,c,{tip:"请使用最新版【手机百度】\n订阅",startDownload:1})):void(clouda.RUNTIME===clouda.RUNTIMES.NUWA&&clouda.NUWA_VERSION>="2.6"&&(nuwa&&nuwa.am&&"function"==typeof nuwa.am.subscribe?nuwa.am.subscribe(c,function(){t.onsuccess(clouda.STATUS.SUCCESS)},function(o){n.error(s.APP_ERROR,o,t)}):document.addEventListener("runtimeready",function(){nuwa.am.subscribe(c,function(){t.onsuccess(clouda.STATUS.SUCCESS)},function(o){n.error(s.APP_ERROR,o,t)})})))}},c.checkFollow=function(o,u){return o?(clouda.lib.utils.setLogStorage("app","checkFollow"),clouda.RUNTIME===clouda.RUNTIMES.KUANG?(a("queryWzStatus",function(o){u.onsuccess(parseInt(o.status,10))},u.onfail),!1):void(clouda.RUNTIME===clouda.RUNTIMES.NUWA&&(nuwa&&nuwa.am&&"function"==typeof nuwa.am.hasSubscribed?nuwa.am.hasSubscribed(o,function(o){u.onsuccess(o?1:0)},function(o){n.error(s.APP_ERROR,o,u)}):document.addEventListener("runtimeready",function(){nuwa.am.hasSubscribed(o,function(o){u.onsuccess(o?1:0)},function(o){n.error(s.APP_ERROR,o,u)})})))):void n.error(s.UNKNOW_INPUT,s.UNKNOW_INPUT,u)},c.checkSupport=function(o){var u={};clouda.RUNTIME===clouda.RUNTIMES.NUWA?u["native"]=1:clouda.RUNTIME===clouda.RUNTIMES.KUANG?u["native"]=BLightApp&&"function"==typeof BLightApp.followSite?1:0:clouda.RUNTIME===clouda.RUNTIMES.WEB&&(u["native"]=0),u.web=0,o(u)}});
;clouda.define("mbaas/socialshare",function(){function e(e){var i=clouda.lightInit.ak||clouda.lightapp.ak,t=document.getElementsByClassName("bdSharePopup");if(1==e.hide){for(var c,d=0,u=t.length;u>d;d++)c=t[d],"block"==c.style.display&&(c.style.display="none");return!1}var s=function(e){var n=e.parentNode;n&&n.removeChild(e)};if(!e.content)return!1;for(var p=t.length,m=p-1;m>=0;m--)t[m]&&s(t[m]);e.linkUrl=e.linkUrl?e.linkUrl:location.href,e.linkUrl=a(e.linkUrl),console.log(e.linkUrl),e.linkUrl=encodeURIComponent(e.linkUrl),e.imageUrl=e.imageUrl?encodeURIComponent(e.imageUrl):"";var f={afterRender:function(){console.log("afterRender exec...")},client_id:i,dom_id:"hidden_btn",content:e.content,theme:"native",appid:e.appid?e.appid:"",animate:!1,url:e.linkUrl,pic_url:e.imageUrl};if(console.log(f),document.querySelector("#hidden_btn"))return o=document.getElementById("hidden_btn"),void socShare.init(f,function(){o.dispatchEvent(r)});var h;h="http:"===window.location.protocol?"http://apps.bdimg.com":"https://openapi.baidu.com";var U=1.5;n(h+"/cloudaapi/socialshare-api/share.min.js?a="+U,function(){var n=["weixin_friend","weixin_timeline","qqfriend","sinaweibo","qqweibo","qqdenglu","renren","sms","email"];if(e.mediaType&&"all"!==e.mediaType){for(var a=!1,t=0,c=n.length;c>t;t++)if(n[t]==e.mediaType){a=!0;break}if(a)return void("weixin_friend"==e.mediaType||"weixin_timeline"==e.mediaType||"qqfriend"==e.mediaType?clouda.lib.moplus.openApp(!0,f.appid):"sinaweibo"==e.mediaType||"qqweibo"==e.mediaType||"renren"==e.mediaType?location.href="http://openapi.baidu.com/social/widget/share?method=share&media_type="+e.mediaType+"&client_id="+i+"&url="+e.linkUrl+"&pic_url="+e.imageUrl+"&content="+encodeURIComponent(e.content)+"&u="+e.linkUrl:"qqdenglu"==e.mediaType?location.href=socShare.acc.getQQHref(f):("sms"==e.mediaType||"email"==e.mediaType)&&socShare.acc.getShortLink({client_id:i,url:e.linkUrl},function(){var n=socShare.acc.shortLinks[e.mediaType];location.href="sms"==e.mediaType?socShare.acc.getSMSHref(e.content,n):socShare.acc.getEmailHref(e.content,n)}))}l=!0,document.querySelector("#hidden_btn")?console.log("js 加载失败"):(o=document.createElement("div"),o.id="hidden_btn",o.style.display="none",document.body.appendChild(o),socShare.init(f,function(){o.dispatchEvent(r)}))})}function n(e,n){var a,i,t,o=document.head||document.getElementsByTagName("head")[0]||document.documentElement;"object"==typeof e&&(i=e,e=void 0),t=i||{},e=e||t.url,n=n||t.success,a=document.createElement("script"),a.id="share_script",a.async=t.async||!1,a.type="text/javascript",a.charset=t.charset?t.charset:"utf-8",a.src=e,o.insertBefore(a,o.firstChild),"function"==typeof n&&(document.addEventListener?a.addEventListener("load",n,!1):a.onreadystatechange=function(){/loaded|complete/.test(a.readyState)&&(a.onreadystatechange=null,n())})}function a(e){var n=e,a=e.match(/^(http:\/\/|https:\/\/)?(.+\?)/i);if(a){for(var i=e.substring(a[0].length),t=i.split("&"),o=[],r=0;r<t.length;r++)t[r].match(/^bd_/)||o.push(t[r]);n=a[0]+o.join("&")}return n}{var i=(clouda.mbaas||{},clouda.lightapp),t=clouda.mbaas.socialshare={};clouda.DelegateClass,clouda.kuangForReady,clouda.runtimeError,clouda.installPlugin,clouda.cloudaBLight}t.loadFlag=1;var o=null,r=document.createEvent("HTMLEvents");r.initEvent("click",!1,!1),r.eventType="message";var l=!1;return t.callShare=function(n){if(clouda.RUNTIME===clouda.RUNTIMES.KUANG&&BLightApp&&"function"==typeof BLightApp.callShare||navigator.userAgent.match(/baiduboxapp\/([\d+.]+)/)&&clouda.RUNTIME_VERSION>="5.3.5"){if(1==n.hide)return!1;if(!n.onsuccess||!n.onfail||"function"!=typeof n.onsuccess||"function"!=typeof n.onfail)return i.error(ErrCode.UNKNOW_INPUT,ErrCode.UNKNOW_INPUT,n),!1;if(!n.content)return i.error(ErrCode.UNKNOW_INPUT,ErrCode.UNKNOW_INPUT,n),!1;if(!n.mediaType)return i.error(ErrCode.UNKNOW_INPUT,ErrCode.UNKNOW_INPUT,n),!1;n.title||(n.title="来自手机百度"),n.linkUrl||(n.linkUrl=location.href),n.linkUrl=a(n.linkUrl);var t=clouda.lib.utils.regcallback(n.onsuccess,n.onfail);if(clouda.RUNTIME===clouda.RUNTIMES.KUANG)BLightApp.callShare(JSON.stringify(n),t.s,t.f);else if("undefined"!=typeof Bdbox_android_utils&&"undefined"!=typeof Bdbox_android_utils.callShare)Bdbox_android_utils.callShare(JSON.stringify(n),t.s,t.f);else if(clouda.PLATFORM===clouda.PLATFORMS.IOS){var o="baiduboxapp://callShare?options="+encodeURIComponent(JSON.stringify(n))+"&errorcallback="+t.f+"&successcallback="+t.s;location.href=o}return!1}if(clouda.RUNTIME===clouda.RUNTIMES.NUWA&&clouda.NUWA_VERSION>="2.6"){{clouda.lightInit.ak||clouda.lightapp.ak}0!==n.menumode&&(n.menumode=1),n.linkUrl=n.linkUrl||location.href,n.imageUrl=n.imageUrl||"",n.mediaType=n.mediaType||"all";var r=function(){n.onsuccess(clouda.STATUS.SUCCESS)},l=function(){i.error(ErrCode.BTY_ERR,nativeErr,n)};return nuwa&&nuwa.sm&&"function"==typeof nuwa.sm.share?nuwa.sm.share(r,l,JSON.stringify(n)):document.addEventListener("runtimeready",function(){nuwa.sm.share(r,l,JSON.stringify(n))}),!1}return e(n),!1},t.checkSupport=function(e){var n={};clouda.RUNTIME===clouda.RUNTIMES.NUWA?n["native"]=0:clouda.RUNTIME===clouda.RUNTIMES.KUANG?n["native"]=BLightApp&&"function"==typeof BLightApp.callShare?1:0:clouda.RUNTIME===clouda.RUNTIMES.WEB&&(n["native"]=navigator.userAgent.match(/baiduboxapp\/([\d+.]+)/)&&clouda.RUNTIME_VERSION>="5.3.5"?1:0),n.web=1,e(n)},t});